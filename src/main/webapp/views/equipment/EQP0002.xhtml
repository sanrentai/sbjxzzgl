<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:h="http://xmlns.jcp.org/jsf/html">
    <p:outputPanel styleClass="Card">
        <!--标题-->
        <h1 class="CardBigTopic Purple">
            <h:outputText value="#{ctrlMaster.createPageTitle('EQP', 'EQP0002')}"/>
        </h1>
        <!--无敌分割线-->
        <div class="SeparatorFull"></div>
        <p:outputPanel id="pnlSelectArea" styleClass="Container30 Responsive100">
            <p:panelGrid styleClass="wd-p-100">
                <f:facet name="header">
                    <p:row>
                        <p:column>
                            <h:outputText value="设备一览"/>
                        </p:column>
                    </p:row>
                </f:facet>
                <p:row>
                    <p:column style="padding: 0px;">
                        <p:tree id="treeCK" value="#{ctrlEQP0001.vm.equipTreeRoot}" var="v" 
                                selectionMode="single" selection="#{ctrlEQP0001.selectedNode}"
                                styleClass="wd-p-100">
<!--                            <p:tree id="treeCK" value="#{ctrlEQP0001.vm.equipTreeRoot}" var="v" 
                                styleClass="wd-p-100">-->
                            <p:ajax event="select" process="treeCK" update="frmMain:fittingTable, frmMain:pnlInputArea" listener="#{ctrlEQP0002.onNodeSelect}"  />

                            <!--根节点-->
                            <!--<p:treeNode type="T_ROOT" expandedIcon="ui-icon-folder-open" collapsedIcon="ui-icon-folder-collapsed">-->
                            <p:treeNode>
                                <h:outputText value="#{v}"/>
                            </p:treeNode>
                        </p:tree>
                    </p:column>
                </p:row>
            </p:panelGrid>
        </p:outputPanel>
        <p:outputPanel styleClass="Container70 Responsive100">
            <p:panelGrid styleClass="wd-p-100">
                <f:facet name="header">
                    <p:row>
                        <p:column>
                            <h:outputText value="配件一览"/>
                        </p:column>
                    </p:row>
                </f:facet>
                <p:row >
                    <p:column>
                        <p:dataTable id="fittingTable" value="#{ctrlEQP0002.vm.equipSelected.equipFittingList}" var="item">
                            <p:column headerText="配件编号">
                                <h:outputText value="#{item.pNmae}"></h:outputText>
                            </p:column>
                            <p:column headerText="配件名称">
                                <h:outputText value="#{item.pNum}"></h:outputText>
                            </p:column>
                        </p:dataTable>
                    </p:column>
                </p:row>
                <p:row >
                    <p:column>
                        <p:outputPanel id="pnlInputArea" styleClass="Container100 Responsive100 NoIndent pnlInputArea">
                            <p:toolbar styleClass="Container100" rendered="#{not empty ctrlEQP0002.vm.equipSelected}">
                                <f:facet name="left">
                                    <p:commandButton value="新建" process="@this" update="pnlInputArea" actionListener="#{ctrlEQP0002.onAddTargetData}" 
                                                     styleClass="NavyButton" disabled="#{ctrlEQP0002.statusEditing}"/>
                                </f:facet>
                            </p:toolbar>
                            <p:outputPanel id="editor" styleClass="Container100 Responsive100 ui-fluid">
                                <p:outputPanel rendered="#{not empty ctrlEQP0002.vm.equipFittingEdited}">
                                    <!--设备编号-->
                                    <p:panelGrid columns="2" layout="grid" styleClass="ui-panelgrid-blank ui-g-12 ui-md-6 ui-lg-4 ht-f-50" columnClasses="wd-p-30 NoPadding,wd-p-70 NoPadding">
                                        <p:outputLabel for="PNum" value="配件编号"/>
                                        <p:inputText id="PNum" value="#{ctrlEQP0002.vm.equipFittingEdited.PNum}" 
                                                     required="true" requiredMessage="#{ctrlEQP0002.isRequiredMessage('配件编号')}"
                                                     maxlength="400" />
                                    </p:panelGrid>
                                    <!--设备名-->
                                    <p:panelGrid columns="2" layout="grid" styleClass="ui-panelgrid-blank ui-g-12 ui-md-6 ui-lg-4 ht-f-50" columnClasses="wd-p-30 NoPadding,wd-p-70 NoPadding">
                                        <p:outputLabel for="PNmae" value="配件名"/>
                                        <p:inputText id="PNmae" value="#{ctrlEQP0002.vm.equipFittingEdited.PNmae}" 
                                                     required="true" requiredMessage="#{ctrlEQP0002.isRequiredMessage('配件名')}"
                                                     maxlength="400" />
                                    </p:panelGrid>

                                    <p:panelGrid columns="5" layout="grid" styleClass="ui-panelgrid-blank">
                                        <p:commandButton value="保存" process="pnlInputArea"
                                                         oncomplete="showErrorMsg();"
                                                         update="frmMain:fittingTable, frmMain:editor"
                                                         actionListener="#{ctrlEQP0002.onSaveData}"/>
                                        <p:commandButton value="取消" process="@this" 
                                                         update="pnlInputArea, frmMain:pnlSelectArea, frmMain:editor" actionListener="#{ctrlEQP0002.onCancelEdit}"
                                                         styleClass="RedButton"/>
                                    </p:panelGrid>
                                </p:outputPanel>
                            </p:outputPanel>
                        </p:outputPanel>
                    </p:column>
                </p:row>
            </p:panelGrid>
        </p:outputPanel>
    </p:outputPanel>
</ui:composition>
